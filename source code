library(tm)
library(SnowballC)
library(cluster)
library(proxy)
library(sentimentr)

txt <- c ()

txt <- VectorSource(txt)
txt <- Corpus(txt)


txt <- tm_map(txt, content_transformer (tolower))
txt <- tm_map(txt, content_transformer (removeNumbers))
txt <- tm_map(txt, content_transformer (removePunctuation))
txt <- tm_map(txt, content_transformer (removeWords), stopwords ("english"))
txt <- tm_map(txt, stemDocument)
txt <- tm_map(txt, stripWhitespace)

inspect(txt)

tdm <- TermDocumentMatrix(txt)

inspect(tdm)
View(as.matrix(tdm[1:15001, 1:1])) 


tdm_tfidf <- weightTfIdf (tdm)
tdm_tfidf <- removeSparseTerms(tdm_tfidf, 0.60)
tfidf_mat <- as.matrix (tdm_tfidf)
dist.mat <- dist (tfidf_mat, method = "cosine")
cl_km <- kmeans (dist.mat, 5)
cl_km

clusplot (tfidf_mat, cl_km$cluster, color = T, main = "Kmeans clustering")
points <- cmdscale (dist.mat, k=4)
plot (points, col=as.factor(cl_km$cluster), main = "points Kmeans clustering")

emo <- emotion(txt)
plot(emo)
